<aside class="sidebar" id="sidebar">
    <div class="sidebar-header">
        <div class="brand-logo">
            <img src="/logo (2).png" alt="TeamPay Logo" class="logo" style="width: 120px; height: 100px; object-fit: contain;">
            <img src="/words.png" alt="TeamPay Logo" class="logo" style="width: 100px; height: 90px; object-fit: contain;">
        </div>
    </div>

    <nav class="sidebar-nav">

        <!-- MAIN (ALL ROLES) -->
        <div class="nav-section role-admin">
            <div class="nav-section-title">Main</div>
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a href="/admin" class="nav-link <%= currentPage === 'dashboard' ? 'active' : '' %>">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
            </ul>
        </div>

        <!-- HR MANAGEMENT (ADMIN ONLY) -->
        <div class="nav-section role-admin">
            <div class="nav-section-title">HR Management</div>
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a href="/admin/employees" class="nav-link <%= currentPage === 'employees' ? 'active' : '' %>">
                        <i class="fas fa-users"></i>
                        <span>Employees</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/admin/departments" class="nav-link <%= currentPage === 'departments' ? 'active' : '' %>">
                        <i class="fas fa-sitemap"></i>
                        <span>Departments</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/admin/grades" class="nav-link <%= currentPage === 'grades' ? 'active' : '' %>">
                        <i class="fas fa-layer-group"></i>
                        <span>Grades</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/admin/positions" class="nav-link <%= currentPage === 'positions' ? 'active' : '' %>">
                        <i class="fas fa-briefcase"></i>
                        <span>Positions</span>
                    </a>
                </li>
            </ul>
        </div>

        <!-- PAYROLL -->
        <div class="nav-section">
            <div class="nav-section-title">Payroll</div>
            <ul class="nav flex-column">


                <!-- In the sidebar partial, update the Process Payroll link -->
                <li class="nav-item">
                <a href="/admin/workflow" class="nav-link <%= currentPage === 'Process Payroll' ? 'active' : '' %>">
                    <i class="fas fa-calculator"></i>
                    <span>Process Payroll</span>
                </a>
                </li>

                <!-- ADMIN ONLY -->
                <li class="nav-item role-admin">
                    <a href="/admin/payrolls" class="nav-link <%= currentPage === 'payrolls' ? 'active' : '' %>">
                        <i class="fas fa-money-check-alt"></i>
                        <span>Processed Payrolls</span>
                    </a>
                </li>

            </ul>
        </div>

        <!-- REPORTS (ADMIN ONLY) -->
        <div class="nav-section role-admin">
            <div class="nav-section-title">Reports</div>
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a href="/admin/reports" class="nav-link <%= currentPage === 'reports' ? 'active' : '' %>">
                        <i class="fas fa-chart-line"></i>
                        <span>Analytics</span>
                    </a>
                </li>
            </ul>
        </div>

        <!-- SYSTEM (ADMIN ONLY) -->
        <div class="nav-section role-admin">
            <div class="nav-section-title">System</div>
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a href="/admin/settings" class="nav-link <%= currentPage === 'settings' ? 'active' : '' %>">
                        <i class="fas fa-cog"></i>
                        <span>Tax Settings</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/admin/company-settings" class="nav-link <%= currentPage === 'company' ? 'active' : '' %>">
                        <i class="fas fa-building"></i>
                        <span>Company Settings</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/admin/users" class="nav-link <%= currentPage === 'users' ? 'active' : '' %>">
                        <i class="fas fa-user-cog"></i>
                        <span>User Management</span>
                    </a>
                </li>
            </ul>
        </div>

    </nav>
</aside>

<!-- ROLE VISIBILITY SCRIPT -->
<script>
document.addEventListener("DOMContentLoaded", function () {
    const userData = localStorage.getItem("user");

    if (!userData) {
        window.location.href = "/";
        return;
    }

    const user = JSON.parse(userData);
    const role = user.role ? user.role.toLowerCase() : "";

    // Hide admin-only elements if not admin
    if (role !== "admin") {
        document.querySelectorAll(".role-admin").forEach(el => el.style.display = "none");
    }
});
</script>
